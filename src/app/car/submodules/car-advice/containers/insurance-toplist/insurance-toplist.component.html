<div class="knx-insurance-toplist">
  <div class="row">
    <div class="col-sm-12">
      <div *ngIf="(isInsuranceLoading$| async)">
        <knx-loader [visible]="(isInsuranceLoading$| async)">
          Een momentje! We vergelijken 19 verschillende aanbieders voor je om de beste match te vinden.
        </knx-loader>
      </div>

      <div *ngIf="noResult()" class="knx-message knx-message--hint">
        Niets gevonden. Ga terug om je keuze aan te passen. Kom je er niet uit? Neem contact op.
      </div>

      <div class="knx-message knx-message--error" *ngIf="isInsuranceError$ | async">
        Oops, er gaat iets verkeerd bij het ophalen van het advies. Kun je het nog een keer proberen?
      </div>

      <div *ngIf="!(isInsuranceError$ | async) && !(isInsuranceLoading$| async)">
        <h2>We hebben {{ insurances.length }} resultaten gevonden</h2>

        <div class="knx-button-group" role="group">
          <button
            *ngFor="let item of orderBy"
            class="knx-button knx-button--toggle"
            [class.knx-button--toggle-active]="item.active"
            (click)="changeOrderBy(item)">{{ item.label }}
          </button>
        </div>

        <knx-insurance-result
          *ngFor="let item of insurances | slice:0:total; let i = index; trackBy: trackInsurance"
          [insurance]="item" [index]="i" (insuranceSelected$)="selectInsurance($event)" [disableButton]="disableInsuranceBuy">
        </knx-insurance-result>

        <button *ngIf="insurances && total < insurances.length" class="knx-button knx-button--secondary knx-button--ghost block-center" (click)="showAll()">
          Toon alle verzekeringen
        </button>

        <div class="knx-insurance-toplist__info">
          <span style="cursor: pointer;">
            Hoe komen we tot deze resultaten?
            <knx-tooltip [options]="{ position: 'bottom' }">
              <p>Onze slimme technologie gaat op basis van de door jou opgegeven informatie aan de slag. We vergelijken
              19 aanbieders en stellen hier een overzicht uit samen. Daarbij kijken we niet alleen naar de prijs.
              Goede polisvoorwaarden en een dekking die past bij jouw persoonlijke situatie, zijn ook belangrijk.</p>

              <p>In het overzicht staan de profielscore en de prijs-kwaliteitverhouding. De verzekering met de hoogste
                score – en dus het best bij je past – staat bovenaan. Verzekeringen die je via Knab afsluit, krijg je
                voor een vast laag percentage.</p>

              <p>Verzekeringen die je niet via ons kunt afsluiten, laten we ook zien. We willen voor jou namelijk de
                best passende verzekering en daarom is het belangrijk dat jij een zo compleet mogelijk beeld krijgt.
                We verwijzen je in dat geval door naar de website van de verzekeraar. Wel zo eerlijk.</p>
            </knx-tooltip>
          </span>
        </div>
      </div>
    </div>
  </div>
</div>

<knx-service-guide
  knxQaIdentifier [qaRoot]="qaRootId" qaIdentifier="service-guide"
  [visible]="!(isInsuranceLoading$| async) && !(isInsuranceError$| async)">
</knx-service-guide>

<knx-wizard-controls [currentStepOptions]="currentStepOptions"
                     [error]="error$ | async"
                     (onNext)="goToNextStep()"
                     (onBack)="goToPreviousStep()">
</knx-wizard-controls>
